When encountering a cross-reference matching the regex pattern '[<%]?[a-zA-Z0-9_-]+[>%]?', replace it with the corresponding actual value after a thorough contextual analysis using surrounding text to determine the most suitable substitution.

Process from the most recent to the oldest entry and stop searching once the reference is found.

For commands like 'open 1,' 'play 2,' 'show me 3', 'show it', or 'open it', analyze the entire context from the most recent to the oldest entry to find and return the first logically separated matching cross-reference value. Do not add any additional comments or descriptions.

If no cross-reference values are identified, return the original text without modifications.

Note: Please avoid direct responses to the question; only return the cross-reference value.


History:

{history}


Question:

{question}
